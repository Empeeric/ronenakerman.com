<!DOCTYPE html><html lang="en"><head><title>index</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="index"><meta name="groc-project-path" content="README.md"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path">README.md</div></div><div id="document"><div class="segment"><div class="comments doc-section"><div class="wrapper"><h2 id="spanclassdocsectionheaderjrowny"><span class='doc-section-header'> jrowny </h2>

<p>If we want to have a complex underlining type we need to "lie" to mongoose</p>

<pre><code class="js">var TwoDWidget = formage.widgets.TextWidget.extend({
    render: function (res) {
        var value = this.value || {};
        var lat = value.lat;
        var lng = value.lng;
        var name = this.name;
        this.name = name + '_lat';
        this.value = lat;
        this._super(res);
        this.name = name + '_lng';
        this.value = lng;
        this._super(res);
    }
});


var TwoDField = formage.fields.StringField.extend({
    init: function (options) {
        options = options || {};
        options.widget = TwoDWidget;
        this._super(options);
    },
    to_schema: function () {
        return {
            lat: Number,
            lng: Number
        };
    },
    clean_value: function (req, callback) {
        var lat = Number(req.body[this.name + '_lat']);
        var lng = Number(req.body[this.name + '_lng']);
        this.value = { lat: lat, lng: lng};
        this._super(req, callback);
    }
});
var TwoD = function TwoD(path, options) {
    TwoD.super_.call(this, path, options);
};
util.inherits(TwoD, Schema.Types.Mixed);
Types.TwoD = Object;
Schema.Types.TwoD = TwoD;

var schema = new mongoose.Schema({
    two_d: { type: TwoD, formageField: TwoDField}
});
</code></pre>

<h2 id="license">License</h2>

<p>MIT</p>

<h2 id="sponsor">Sponsor</h2>

<p><a id="stormlogo" href="http://www.jetbrains.com/webstorm/" alt="Smart IDE for web development with HTML Editor, CSS &amp; JavaScript support" title="Smart IDE for web development with HTML Editor, CSS &amp; JavaScript support">
  <img src="http://i.imgur.com/ynQ6c.png" alt="" title="" />
</a></span></p>

<h1 id="imgsrchttpiimgurcom9vvhcpypngaligntopformagebuildstatushttpstravisciorgempeericformagepngbranchmasterhttpstravisciorgempeericformage"><img src="http://i.imgur.com/9vVHCPY.png" align="top" />  Formage <a href="https://travis-ci.org/Empeeric/formage"><img src="https://travis-ci.org/Empeeric/formage.png?branch=master" alt="Build Status" title="" /></a></h1>

<p><a href="http://twitter.github.com/bootstrap/">Bootstraped</a> Admin Forms for MongoDB via <a href="http://mongoosejs.com/">Mongoose</a>,
originally forked from <a href="https://github.com/marccampbell/mongoose-admin">mongoose-admin</a>.</p>

<h2 id="usage">Usage</h2>

[![npm install formage](https://nodei.co/npm/formage.png?downloads=true)](https://nodei.co/npm/formage/)
<!-- [![NPM](https://nodei.co/npm-dl/formage.png)](https://nodei.co/npm/formage/) -->

<pre><code class="js">var express = require('express'),
    app = express();

require('formage').init(app, express [, models, options]);
</code></pre>

<p>Look at <code>\example</code> directory.</p>

<h2 id="options">Options</h2>

<pre><code class="js">// Site-wide options, and their default values
require('formage').init(app, express, models, {
    title: 'Admin',
    root: '/admin',
    default_section: 'main',
    username: 'admin',
    password: 'admin'
);
</code></pre>

<h4 id="model-options">Model options</h4>

<pre><code class="js">var model = new mongoose.model('songs', schema);

model.label = 'My Songs';
model.singular = 'Song';

// external files specific to this model
model.static = {
   js: [ '/js/songs.js' ],
   css: ['/css/songs.css' ]
};

// one-document models
model.single = true;

model.formage = {
    filters: ['artist', 'year'],

    // additional actions on this model
    actions: [
       {
          value: 'release',
          label: 'Release',
          func: function (user, ids, callback) {
             console.log('You just released songs ' + ids);
             callback();
          }
       }
    ],

    // list of fields to be displayed by formage for this model
    list: ['number', 'title', 'album', 'artist', 'year'],

    // list of order fields
    order_by: ['-year', 'album', 'number'],

    // list of fields that must be populated
    // (see http://mongoosejs.com/docs/api.html#document_Document-populate)
    list_populate: ['album'],

    // list of fields on which full-text search is available
    search: ['title', 'album', 'artist']
};
</code></pre>

<h4 id="field-options">Field options</h4>

<pre><code class="js">var schema = new mongoose.Schema({
    artist: { type: String, label: 'Who made it?' },
    // lang is a two letter ISO 639-1 code as recognized by google
    location: { type: Schema.Types.GeoPoint, widget_options: {lang: 'nl'}}
});
</code></pre>

<p><a href="http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a></p>

<h4 id="extending">Extending</h4>

<pre><code class=" js">var ReversedWidget = formage.widgets.TextWidget.extend({
    render: function (res) {
        this.value = this.value.split("").reverse().join("");
        this.attrs.style = '-moz-transform: scale(-1, 1); -webkit-transform: scale(-1, 1); transform: scale(-1, 1);';
        this._super(res);
    }
});

var ReversedField = formage.fields.StringField.extend({
    init: function (options) {
        options = options || {};
        options.widget = ReversedWidget;
        this._super(options);
    },
    clean_value: function (req, callback) {
        this.value = this.value.split("").reverse().join("");
        this._super(req, callback);
    }
});

var schema = new mongoose.Schema({
    reversed: { type: String, formageField: ReversedField}
});
</code></pre></div></div></div></div></body></html>